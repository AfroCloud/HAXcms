define(["exports","../../../@polymer/polymer/polymer-element.js","../../../@polymer/iron-resizable-behavior/iron-resizable-behavior.js","../../es-global-bridge/es-global-bridge.js","../../../@polymer/polymer/lib/utils/resolve-url.js"],function(_exports,_polymerElement){"use strict";Object.defineProperty(_exports,"__esModule",{value:!0});_exports.AbsolutePositionStateManager=void 0;window.AbsolutePositionStateManager=window.AbsolutePositionStateManager||{};window.AbsolutePositionStateManager.requestAvailability=function(){if(!window.AbsolutePositionStateManager.instance){window.AbsolutePositionStateManager.instance=document.createElement("absolute-position-state-manager");document.body.appendChild(window.AbsolutePositionStateManager.instance)}return window.AbsolutePositionStateManager.instance};var AbsolutePositionStateManager=function(_PolymerElement){babelHelpers.inherits(AbsolutePositionStateManager,_PolymerElement);babelHelpers.createClass(AbsolutePositionStateManager,null,[{key:"tag",get:function get(){return"absolute-position-state-manager"}},{key:"properties",get:function get(){return{elements:{type:Array,value:[]}}}}]);function AbsolutePositionStateManager(){var _this;babelHelpers.classCallCheck(this,AbsolutePositionStateManager);_this=babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(AbsolutePositionStateManager).call(this));babelHelpers.assertThisInitialized(babelHelpers.assertThisInitialized(_this));if(!window.AbsolutePositionStateManager.instance){window.AbsolutePositionStateManager.instance=babelHelpers.assertThisInitialized(babelHelpers.assertThisInitialized(_this));return babelHelpers.possibleConstructorReturn(_this,babelHelpers.assertThisInitialized(babelHelpers.assertThisInitialized(_this)))}return _this}babelHelpers.createClass(AbsolutePositionStateManager,[{key:"connectedCallback",value:function connectedCallback(){babelHelpers.get(babelHelpers.getPrototypeOf(AbsolutePositionStateManager.prototype),"connectedCallback",this).call(this)}},{key:"loadElement",value:function loadElement(el){var root=this;root.__on=root.__on!==void 0?root.__on:!1;root.elements.push(el);root.updatePosition(el);if(!root.__on)root.addEventListeners();root.__on=!0}},{key:"unloadElement",value:function unloadElement(el){var root=this;root.elements.filter(function(element){return element===el});root.__on=0<root.elements;if(!root.__on)root.removeEventListeners()}},{key:"addEventListeners",value:function addEventListeners(){var root=this;root.__timeout=!1;root.updateElements();document.addEventListener("load",root.updateElements());window.addEventListener("resize",function(){clearTimeout(root.__timeout);root.__timeout=setTimeout(root.updateElements(),250)});root.__observer=new MutationObserver(function(){root.updateElements()});root.__observer.observe(document,{attributes:!0,childList:!0,subtree:!0,characterData:!0})}},{key:"findTarget",value:function findTarget(el){var parentNode=el.parentNode,ownerRoot=el.shadowRoot,target;if(el.for){target=parentNode.querySelector("#"+el.for)}else{target=parentNode.nodeType==Node.DOCUMENT_FRAGMENT_NODE?ownerRoot.host:parentNode}return target}},{key:"removeEventListeners",value:function removeEventListeners(){var root=this;document.removeEventListener("load",root.updateElements());window.removeEventListener("resize",function(){clearTimeout(root.__timeout);root.__timeout=setTimeout(root.updateElements(),250)});root.__observer.disconnect()}},{key:"updateElements",value:function updateElements(){var root=this;root.elements.forEach(function(element){root.updatePosition(element)})}},{key:"updatePosition",value:function updatePosition(element){var _Mathmax=Math.max,target=this.findTarget(element);if(!target||!this.offsetParent)return;var offset=element.offset,parentRect=element.offsetParent.getBoundingClientRect(),targetRect=target.getBoundingClientRect(),elementRect=element.getBoundingClientRect(),horizontalCenterOffset=(targetRect.width-elementRect.width)/2,verticalCenterOffset=(targetRect.height-elementRect.height)/2,tooltipLeft,tooltipTop;switch(element.position){case"top":tooltipLeft=targetRect.left+horizontalCenterOffset;tooltipTop=targetRect.top-elementRect.height-offset;break;case"bottom":tooltipLeft=targetRect.left+horizontalCenterOffset;tooltipTop=targetRect.top+targetRect.height+offset;break;case"left":tooltipLeft=targetRect.left-elementRect.width-offset;tooltipTop=targetRect.top+verticalCenterOffset;break;case"right":tooltipLeft=targetRect.left+targetRect.width+offset;tooltipTop=targetRect.top+verticalCenterOffset;break;}element.style.position="absolute";if(element.fitToVisibleBounds){if(parentRect.left+tooltipLeft+elementRect.width>window.innerWidth){element.style.right="0px";element.style.left="auto"}else{element.style.left=_Mathmax(0,tooltipLeft)+"px";element.style.right="auto"}if(parentRect.top+tooltipTop+elementRect.height>window.innerHeight){element.style.bottom=parentRect.height-targetRect.top+offset+"px";element.style.top="auto"}else{element.style.top=_Mathmax(-parentRect.top,tooltipTop)+"px";element.style.bottom="auto"}}else{element.style.left=tooltipLeft+"px";element.style.top=tooltipTop+"px"}}},{key:"disconnectedCallback",value:function disconnectedCallback(){babelHelpers.get(babelHelpers.getPrototypeOf(AbsolutePositionStateManager.prototype),"disconnectedCallback",this).call(this);this.removeEventListeners()}}]);return AbsolutePositionStateManager}(_polymerElement.PolymerElement);_exports.AbsolutePositionStateManager=AbsolutePositionStateManager;window.customElements.define(AbsolutePositionStateManager.tag,AbsolutePositionStateManager)});